<div id="formDiv">
  <!-- <font color="blue">證件上傳</font><br> -->
  * 每個圖檔大小不得超過2MB
  <form id="myForm">
      大頭照: <input name="headshot" type="file" onclick="updateOutput('')" /><br/>
      救生證正面: <input name="license1" type="file" onclick="updateOutput('')" /><br/>
      教練證正面: <input name="license2" type="file" onclick="updateOutput('')" /><br/>
      <input type="button" value="上傳" onclick="picUploadJs(this.parentNode)" />
  </form>
</div>


<div id="status" style="display: inline">
  <!-- div will be filled with innerHTML after form submission. -->
  <!-- // Uploading. Please wait... -->
</div>


<script>

function picUploadJs(frmData) {
  document.getElementById('status').style.display = 'inline';
  updateOutput("上傳中...")

  var ret = google.script.run
    .withSuccessHandler(doneOutput)
    .withFailureHandler(badOutput)
    .processForm(frmData)
}


function updateOutput(text) {
  var outputDiv = document.getElementById('status');
  outputDiv.style.color="blue"
  outputDiv.innerHTML = text;
}

function doneOutput(e) {
  var outputDiv = document.getElementById('status');
  outputDiv.style.color="green"
  outputDiv.innerHTML = "上傳成功!";
  
  var list = ["headshot","license1","license2"]
  
  for( var i in list ) {
    var input = document.getElementsByName(list[i])[0]
    input.value=""
    console.log(input.value)
  }
}

function badOutput(e) {
  var outputDiv = document.getElementById('status');
  outputDiv.style.color="red"
  if( e ) {
    outputDiv.innerHTML = e;
  } else {
    outputDiv.innerHTML = "失敗! 請重新上傳!";  
  }
//  
}


</script>